<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SMKN 1 Praya Barat</title>

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:Arial}
body{background:#f5f7fa}
header{background:#0b5ed7;color:#fff;padding:20px}

nav{background:#084298}
nav ul{list-style:none}
nav li{border-bottom:1px solid rgba(255,255,255,.15)}
nav a{
  color:#fff;padding:14px 16px;
  display:flex;justify-content:space-between;
  text-decoration:none;cursor:pointer
}
nav a:hover{background:#0d6efd}

.submenu{
  background:#0b5ed7;
  max-height:0;
  overflow:hidden;
  transition:max-height .3s ease;
}
.has-sub.open .submenu{max-height:400px}
.arrow{transition:.3s}
.has-sub.open .arrow{transform:rotate(180deg)}

.container{padding:20px}
.hero,.card{background:#fff;padding:20px;border-radius:8px;margin-bottom:20px}
section{display:none}
section.active{display:block}

table{width:100%;border-collapse:collapse}
th,td{border:1px solid #ccc;padding:6px;text-align:left}

button{padding:8px 12px;background:#0b5ed7;color:#fff;border:none;border-radius:4px;cursor:pointer}
button:hover{opacity:.9}

footer{background:#084298;color:#fff;text-align:center;padding:15px}
</style>
</head>

<body>

<header>
<h1>SMKN 1 Praya Barat</h1>
<p>Website Resmi Sekolah</p>
</header>

<nav>
<ul>
<li><a onclick="showMenu('beranda')">Beranda</a></li>

<li class="has-sub">
<a onclick="toggleSub(this)">Profil <span class="arrow">‚ñæ</span></a>
<ul class="submenu">
<li><a onclick="go('profil')">Profil Sekolah</a></li>
<li><a onclick="go('visi')">Visi & Misi</a></li>
</ul>
</li>

<li><a onclick="showMenu('ppdb')">PPDB</a></li>

<!-- MENU ADMIN TERSEMBUNYI -->
<li id="adminMenu" style="display:none">
<a onclick="showMenu('admin')">üîí Admin</a>
</li>
</ul>
</nav>

<!-- ====== HALAMAN ====== -->
<section id="beranda" class="container active">
<div class="hero"><h2>Selamat Datang</h2></div>
</section>

<section id="profil" class="container"><div class="card"><h2>Profil Sekolah</h2></div></section>
<section id="visi" class="container"><div class="card"><h2>Visi & Misi</h2></div></section>

<!-- PPDB SISWA -->
<section id="ppdb" class="container">
<div class="card">
<h2>PPDB Online</h2>
<form onsubmit="daftarPPDB(event)">
<input id="nama" placeholder="Nama Lengkap" required>
<input id="nisn" placeholder="NISN" required>
<input id="asal" placeholder="Asal Sekolah" required>
<select id="jurusan" required>
<option value="">Pilih Jurusan</option>
<option>DKV</option>
<option>Perhotelan</option>
<option>Tata Boga</option>
</select>
<button>Daftar</button>
</form>
<div id="hasil"></div>
</div>
</section>

<!-- ===== ADMIN ===== -->
<section id="admin" class="container">

<!-- LOGIN -->
<div class="card" id="loginBox">
<h2>üîê Login Admin</h2>
<input id="email" placeholder="Email">
<input id="password" type="password" placeholder="Password">
<button onclick="login()">Login</button>
<div id="loginInfo"></div>
</div>

<!-- PANEL -->
<div class="card" id="panelBox" style="display:none">
<h2>üìã Panel Admin PPDB</h2>
<button onclick="logout()">Logout</button>
<br><br>

<button onclick="exportExcel()">‚¨á Export Excel</button>
<br><br>

<table>
<thead>
<tr>
<th>Nama</th>
<th>NISN</th>
<th>Asal</th>
<th>Jurusan</th>
<th>Status</th>
<th>Aksi</th>
</tr>
</thead>
<tbody id="ppdbList"></tbody>
</table>
</div>

</section>

<footer id="secret">¬© 2026 SMKN 1 Praya Barat</footer>

<!-- XLSX -->
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<!-- ===== FIREBASE ===== -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, updateDoc, doc } 
from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";
import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } 
from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";

const firebaseConfig = {
 apiKey: "API_KEY",
 authDomain: "PROJECT.firebaseapp.com",
 projectId: "PROJECT"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

/* PPDB SISWA */
window.daftarPPDB = async e=>{
 e.preventDefault();
 await addDoc(collection(db,"ppdb"),{
  nama:nama.value,
  nisn:nisn.value,
  asal:asal.value,
  jurusan:jurusan.value,
  status:"Pending",
  waktu:new Date()
 });
 hasil.innerHTML="‚úÖ Pendaftaran berhasil";
};

/* LOGIN ADMIN */
window.login = async ()=>{
 try{
  await signInWithEmailAndPassword(auth,email.value,password.value);
 }catch{
  loginInfo.innerHTML="‚ùå Login gagal";
 }
};

window.logout = async ()=>{ await signOut(auth); };

/* AUTH */
onAuthStateChanged(auth,user=>{
 if(user){
  loginBox.style.display="none";
  panelBox.style.display="block";
  loadPPDB();
 }else{
  loginBox.style.display="block";
  panelBox.style.display="none";
 }
});

/* LOAD PPDB */
window.loadPPDB = async ()=>{
 ppdbList.innerHTML="";
 const snap = await getDocs(collection(db,"ppdb"));
 snap.forEach(d=>{
  const x=d.data();
  ppdbList.innerHTML+=`
  <tr>
   <td>${x.nama}</td>
   <td>${x.nisn}</td>
   <td>${x.asal}</td>
   <td>${x.jurusan}</td>
   <td>${x.status}</td>
   <td>
    <button onclick="verifikasi('${d.id}','Diterima')">‚úî</button>
    <button onclick="verifikasi('${d.id}','Ditolak')">‚úñ</button>
   </td>
  </tr>`;
 });
};

window.verifikasi = async (id,status)=>{
 await updateDoc(doc(db,"ppdb",id),{status});
 loadPPDB();
};

/* EXPORT EXCEL */
window.exportExcel = async ()=>{
 const snap = await getDocs(collection(db,"ppdb"));
 const data=[];
 snap.forEach(d=>data.push(d.data()));
 const ws=XLSX.utils.json_to_sheet(data);
 const wb=XLSX.utils.book_new();
 XLSX.utils.book_append_sheet(wb,ws,"PPDB");
 XLSX.writeFile(wb,"Data_PPDB_SMKN1.xlsx");
};
</script>

<!-- MENU JS -->
<script>
function toggleSub(el){
 const li=el.parentElement;
 document.querySelectorAll(".has-sub").forEach(x=>x!==li&&x.classList.remove("open"));
 li.classList.toggle("open");
}
function showMenu(id){
 document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
 document.getElementById(id).classList.add("active");
}
function go(id){showMenu(id);}
let c=0;
secret.onclick=()=>{if(++c==5)adminMenu.style.display="block";setTimeout(()=>c=0,1200);}
</script>

</body>
</html>
